(this.webpackJsonpcarta=this.webpackJsonpcarta||[]).push([[0],{48:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var c=n(8),a=n.n(c),i=n(41),s=n.n(i),r=(n(48),n(33)),o=n(16),l=n(26),u=n.n(l),d=n(20);d.a.apps.length||d.a.initializeApp({apiKey:"AIzaSyA8S-srH-tHf8zNFjm-K8wExlaxY0xEn0Q",authDomain:"carta-engine.firebaseapp.com",projectId:"carta-engine",storageBucket:"carta-engine.appspot.com",messagingSenderId:"129718650492",appId:"1:129718650492:web:6a0311a65b93ebbef36bf9",measurementId:"G-T9VZHWB6KX"});var j=new d.a.auth.GoogleAuthProvider,b=d.a.auth(),h=d.a,f=(n(42),n(32),n(43),n(6)),g=n(21),v=n(19),O=(n(95),function(e){var t=e.callback,n=e.settings;return Object(f.jsxs)("div",{id:"toolbar",children:[Object(f.jsx)("div",{className:"item",onClick:function(){return t("color")},children:Object(f.jsx)(g.a,{icon:v.e,className:"light-icon"})}),Object(f.jsx)("div",{className:"item",onClick:function(){return t("shape")},children:Object(f.jsx)(g.a,{icon:v.d,className:"light-icon"})}),Object(f.jsx)("div",{className:"item",onClick:function(){return t("grid")},children:Object(f.jsx)(g.a,{icon:n.gridMode?v.a:v.b,className:"light-icon"})}),Object(f.jsx)("div",{className:"item",onClick:function(){return t("clean")},children:Object(f.jsx)(g.a,{icon:v.c,className:"light-icon"})})]})}),x=(n(96),function(){var e=Object(c.useState)({gridMode:!1,color:"#00F"}),t=Object(o.a)(e,2),n=t[0],a=t[1],i=Object(c.useRef)(),s=Object(c.useState)(null),l=Object(o.a)(s,2),d=l[0],g=l[1],v=Object(c.useState)(""),x=Object(o.a)(v,2),m=(x[0],x[1],Object(c.useState)([])),p=Object(o.a)(m,2),y=(p[0],p[1]),k=Object(c.useState)(null),w=Object(o.a)(k,2),N=w[0],C=w[1];Object(c.useEffect)((function(){b.onAuthStateChanged((function(e){e&&(C(e),h.database().ref("users").on("value",(function(e){var t=e.val(),n=[];for(var c in t){var a=t[c].items;for(var i in a)n.push({id:i,uid:c,title:a[i].title,user:a[i].user})}y(n)})),g(new u.a.Stage({container:"canvas",width:i.current.clientWidth,height:i.current.clientHeight})))}))}),[]),Object(c.useEffect)((function(){if(d){var e=h.database().ref("canvas/test/items");e.get().then((function(e){return S(e.val())})),e.on("value",(function(e){return S(e.val())}))}}),[d]);var S=function(e){var t=[],n=new u.a.Layer,c=function(c){c&&(t.push({id:c,x:e[c].x,y:e[c].y}),(i=new u.a.Circle({x:e[c].x,y:e[c].y,radius:70,fill:"red",stroke:"black",strokeWidth:4})).draggable("true"),n.add(i),i.on("dragend",(function(e){var t=e.target.getPosition();console.log("".concat(c,": (").concat(t.x,", ").concat(t.y,")")),h.database().ref("canvas/test/items/".concat(c)).update({x:t.x,y:t.y})})))};for(var a in e){var i;c(a)}d.off("click"),d.on("click",(function(e){(console.log(e.evt),e.evt.shiftKey)||h.database().ref("canvas/test/items/").push({x:e.evt.layerX,y:e.evt.layerY})})),d.destroyChildren(),d.add(n),d.draw()};Object(c.useEffect)((function(){window.addEventListener("resize",(function(){null===d||void 0===d||d.size({width:i.current.clientWidth,height:i.current.clientHeight})}))}));return Object(f.jsxs)("div",{className:"app",children:[Object(f.jsx)("header",{children:Object(f.jsxs)("div",{className:"wrapper",children:[Object(f.jsx)("h1",{children:"CARTA"}),Object(f.jsx)("div",{className:"user-profile",children:N?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("img",{src:N.photoURL}),Object(f.jsx)("button",{onClick:function(){b.signOut().then((function(){C(null)}))},children:"Log Out"})]}):Object(f.jsx)("button",{onClick:function(){b.signInWithPopup(j).then((function(e){var t=e.user;C(t)}))},children:"Log In"})})]})}),N?Object(f.jsx)("div",{children:Object(f.jsxs)("div",{className:"container",ref:i,children:[Object(f.jsx)("div",{id:"canvas"}),Object(f.jsx)(O,{callback:function(e){("grid"===e&&a(Object(r.a)(Object(r.a)({},n),{},{gridMode:!n.gridMode})),"clean"===e)&&h.database().ref("canvas/test/items").remove()},settings:n})]})}):Object(f.jsx)("div",{className:"wrapper",children:Object(f.jsx)("p",{children:"You must be logged in to see your maps."})})]})}),m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,98)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(x,{})}),document.getElementById("root")),m()}},[[97,1,2]]]);
//# sourceMappingURL=main.0f26373d.chunk.js.map